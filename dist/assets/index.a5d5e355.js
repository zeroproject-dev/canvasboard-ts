var Z=Object.defineProperty;var F=(l,e,t)=>e in l?Z(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var h=(l,e,t)=>(F(l,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=t(r);fetch(r.href,c)}})();class G{constructor(){h(this,"throttleTime",10)}onResizeEvent(e){window.addEventListener("resize",e)}onKeydownEvent(e){window.addEventListener("keydown",e)}onKeyupEvent(e){window.addEventListener("keyup",e)}onKeypressEvent(e){window.addEventListener("keypress",e)}onMouseDownEvent(e){i.canvas.addEventListener("mousedown",e)}onMouseMoveEvent(e){i.canvas.addEventListener("mousemove",this.throttle(e,this.throttleTime))}onMouseUpEvent(e){i.canvas.addEventListener("mouseup",e)}onMouseLeaveEvent(e){i.canvas.addEventListener("mouseleave",e)}onWheelEvent(e){i.canvas.addEventListener("wheel",e)}onTouchStartEvent(e){i.canvas.addEventListener("touchstart",e)}onTouchMoveEvent(e){i.canvas.addEventListener("touchmove",this.throttle(e,this.throttleTime))}onTouchEndEvent(e){i.canvas.addEventListener("touchend",e)}onContextMenuEvent(e){i.canvas.addEventListener("contextmenu",e)}throttle(e,t){let o=!1;return function(r){o||(e.apply(null,[r]),o=!0,setTimeout(function(){o=!1},t))}}}class n{static toScreenX(e){return(e+s.offsetX)*s.scale}static toScreenY(e){return(e+s.offsetY)*s.scale}static toWorldX(e){return e/s.scale-s.offsetX}static toWorldY(e){return e/s.scale-s.offsetY}static getWidth(){return i.canvas.clientWidth/s.scale}static getHeight(){return i.canvas.clientHeight/s.scale}}h(n,"cursorX",0),h(n,"cursorY",0),h(n,"prevCursorX",0),h(n,"prevCursorY",0),h(n,"prevTouches",[null,null]);class Q{constructor(e){h(this,"properties");h(this,"type",f.Circle);h(this,"worldCenterX");h(this,"worldCenterY");h(this,"radiusX");h(this,"radiusY");this.properties=e,this.worldCenterX=0,this.worldCenterY=0,this.radiusX=0,this.radiusY=0}startDraw(e){const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;this.properties.fill=s.fill,this.properties.initialX=t,this.properties.initialY=o}draw(e){i.clearCanvas(),i.reDraw(),i.ctx.beginPath(),i.ctx.strokeStyle=this.properties.strokeColor,i.ctx.fillStyle=this.properties.fillColor,i.ctx.lineWidth=this.properties.lineWidth*s.scale;const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;let r=(t-this.properties.initialX)/2,c=(o-this.properties.initialY)/2;if(i.isPerfectShape){const p=Math.min(Math.abs(r),Math.abs(c)),w=r<0?-1:1,g=c<0?-1:1;r=p*w,c=p*g}let u=this.properties.initialX+r,d=this.properties.initialY+c;r=Math.abs(r),c=Math.abs(c),this.worldCenterX=n.toWorldX(u),this.worldCenterY=n.toWorldY(d),this.radiusX=r/s.scale,this.radiusY=c/s.scale,i.ctx.ellipse(u,d,r,c,0,0,2*Math.PI),this.properties.fill?i.ctx.fill():i.ctx.stroke(),i.ctx.closePath()}reDraw(){i.ctx.strokeStyle=this.properties.strokeColor,i.ctx.lineWidth=this.properties.lineWidth*s.scale,i.ctx.ellipse(n.toScreenX(this.worldCenterX),n.toScreenY(this.worldCenterY),this.radiusX*s.scale,this.radiusY*s.scale,0,0,2*Math.PI),this.properties.fill?i.ctx.fill():i.ctx.stroke()}cancelDraw(){i.clearCanvas(),i.reDraw()}endDraw(){i.ctx.closePath()}isEmpty(){return this.radiusX===0&&this.radiusY===0}}class W{constructor(e){h(this,"line");h(this,"initialRealX");h(this,"initialRealY");h(this,"properties");h(this,"type",f.HandDrawing);this.line=[],this.initialRealX=0,this.initialRealY=0,this.properties=e}cancelDraw(){this.line=[]}startDraw(e){i.ctx.beginPath();const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;this.properties.initialX=t,this.properties.initialY=o,this.initialRealX=n.toWorldX(t),this.initialRealY=n.toWorldY(o)}draw(e){const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;if(i.clearCanvas(),i.reDraw(),i.ctx.beginPath(),i.isPerfectShape)i.ctx.moveTo(this.properties.initialX,this.properties.initialY),i.ctx.lineTo(t,o);else{let r=[this.initialRealX,this.initialRealY];this.line.push([n.toWorldX(t),n.toWorldY(o)]);let c=this.line[0];for(let u=1;u<this.line.length;u++){let d=this.midPoint(r,c);i.ctx.quadraticCurveTo(n.toScreenX(r[0]),n.toScreenY(r[1]),n.toScreenX(d[0]),n.toScreenY(d[1])),r=this.line[u],c=this.line[u+1]}}i.ctx.stroke(),i.ctx.closePath()}midPoint(e,t){return[e[0]+(t[0]-e[0])/2,e[1]+(t[1]-e[1])/2]}reDraw(){if(this.line.length>2){i.ctx.beginPath();let e=[this.initialRealX,this.initialRealY],t=this.line[0];i.ctx.moveTo(n.toScreenX(this.initialRealX),n.toScreenY(this.initialRealY));for(let o=1;o<this.line.length;o++){let r=this.midPoint(e,t);i.ctx.quadraticCurveTo(n.toScreenX(e[0]),n.toScreenY(e[1]),n.toScreenX(r[0]),n.toScreenY(r[1])),e=this.line[o],t=this.line[o+1]}i.ctx.stroke(),i.ctx.closePath()}else{for(let e=0;e<this.line.length;e++)i.ctx.lineTo(n.toScreenX(this.line[e][0]),n.toScreenY(this.line[e][1]));i.ctx.stroke()}}endDraw(e){if(i.isPerfectShape){const t=e instanceof MouseEvent?e.pageX:e.changedTouches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.changedTouches[0].pageY;this.line=[];const r=[n.toWorldX(t),n.toWorldY(o)];this.line.push([n.toWorldX(this.properties.initialX),n.toWorldY(this.properties.initialY)]),this.line.push(r)}this.line.length>2&&(this.line=this.normalizeArray(this.line)),i.ctx.closePath()}isEmpty(){return this.line.length===0}normalizeArray(e){let t=[];return t=e.filter((o,r)=>{if(r===0||r===e.length-1)return!0;const c=e[r-1];return!(c[0]===o[0]||c[1]===o[1])}),t.push([e[e.length-1][0],e[e.length-1][1]]),t}}class V{constructor(e){h(this,"properties");h(this,"type",f.Rectangle);h(this,"initialRealX");h(this,"initialRealY");h(this,"width");h(this,"height");this.properties=e,this.initialRealX=0,this.initialRealY=0,this.width=0,this.height=0}startDraw(e){const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;this.properties.fill=s.fill,this.properties.initialX=t,this.properties.initialY=o,this.initialRealX=n.toWorldX(t),this.initialRealY=n.toWorldY(o)}draw(e){i.clearCanvas(),i.reDraw(),i.ctx.beginPath(),i.ctx.strokeStyle=this.properties.strokeColor,i.ctx.fillStyle=this.properties.fillColor,i.ctx.lineWidth=this.properties.lineWidth*s.scale;const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,o=e instanceof MouseEvent?e.pageY:e.touches[0].pageY;let r=t-this.properties.initialX,c=o-this.properties.initialY;if(i.isPerfectShape){const u=Math.min(Math.abs(r),Math.abs(c));let d=c<0?-1:1,p=r<0?-1:1;r=u*p,c=u*d}this.width=r/s.scale,this.height=c/s.scale,this.properties.fill?i.ctx.fillRect(this.properties.initialX,this.properties.initialY,r,c):i.ctx.rect(this.properties.initialX,this.properties.initialY,r,c),i.ctx.stroke(),i.ctx.closePath()}reDraw(){i.ctx.strokeStyle=this.properties.strokeColor,i.ctx.lineWidth=this.properties.lineWidth*s.scale,this.properties.fill?i.ctx.fillRect(n.toScreenX(this.initialRealX),n.toScreenY(this.initialRealY),this.width*s.scale,this.height*s.scale):i.ctx.rect(n.toScreenX(this.initialRealX),n.toScreenY(this.initialRealY),this.width*s.scale,this.height*s.scale),i.ctx.stroke()}cancelDraw(){i.clearCanvas(),i.reDraw()}endDraw(){i.ctx.closePath()}isEmpty(){return this.width===0&&this.height===0}}class T{static create(e,t={}){switch(e){case f.HandDrawing:return new W(t);case f.Rectangle:return new V(t);case f.Circle:return new Q(t);default:return new W(t)}}}var f=(l=>(l.HandDrawing="HandDrawing",l.Rectangle="Rectangle",l.Circle="Circle",l))(f||{});const k=document.getElementById("stroke_color"),L=document.getElementById("fill_color"),R=document.getElementById("canvas_color"),D=document.getElementById("size"),P=D.nextElementSibling,N=document.getElementById("drawables"),H=document.getElementById("fill"),_=(l,e)=>{let t=l.parentElement;for(;t!==null;){if(t.tagName===e)return t;t=t.parentElement}return l},ee=()=>{const l=localStorage.getItem("history");l!==null&&(JSON.parse(l).forEach(t=>{const o=t.type,r=T.create(o);Object.assign(r,t),i.history.push(r)}),i.reDraw())},y=()=>{localStorage.setItem("history",JSON.stringify(i.history))},I={strokeColor:"#f4f4f4",fillColor:"#f4f4f4",canvasColor:"#1e1e1e",lineWidth:10,fill:!1,currentDrawable:"HandDrawing",offsetX:0,offsetY:0,scale:1},s=new Proxy(I,{get:(l,e)=>l[e],set:(l,e,t)=>{switch(e){case"offsetX":case"offsetY":case"scale":l[e]=t;break;case"strokeColor":l.strokeColor=t,k.value=t,i.ctx.strokeStyle=t;break;case"lineWidth":l.lineWidth=t,D.value=t,P.value=t,i.ctx.lineWidth=t;break;case"fillColor":l.fillColor=t,L.value=t,i.ctx.fillStyle=t;break;case"canvasColor":l.canvasColor=t,R.value=t,i.reDraw();break;case"fill":l.fill=t,H.checked=t;break;case"currentDrawable":l.currentDrawable=t,se();break}return ie(),!0}}),te=()=>{i.ctx.lineJoin="round",i.ctx.lineCap="round";const l=localStorage.getItem("config");if(l!==null){const e=JSON.parse(l);Object.assign(s,e)}},ie=()=>{localStorage.setItem("config",JSON.stringify(I))},se=()=>{N.childNodes.forEach(l=>{if(l.nodeType===Node.ELEMENT_NODE){const e=l;e.classList.remove("selected_draw"),e.dataset.type===s.currentDrawable&&e.classList.add("selected_draw")}})},ne=()=>{D.addEventListener("input",e=>{const t=e.target;s.lineWidth=Number(t.value)}),P.addEventListener("input",e=>{const t=e.target;if(Number(t.value)>50){s.lineWidth=50;return}else if(Number(t.value)<1){s.lineWidth=1;return}s.lineWidth=Number(t.value)}),k.addEventListener("change",({target:e})=>{s.strokeColor=e.value}),L.addEventListener("change",({target:e})=>{s.fillColor=e.value}),R.addEventListener("change",({target:e})=>{s.canvasColor=e.value}),H.addEventListener("change",({target:e})=>{s.fill=e.checked}),document.getElementById("clear").addEventListener("click",()=>{i.clearBoard()}),document.getElementById("reset").addEventListener("click",()=>{Object.assign(s,{strokeColor:"#f4f4f4",fillColor:"#f4f4f4",canvasColor:"#1e1e1e",lineWidth:10,fill:!1,currentDrawable:"HandDrawing",offsetX:0,offsetY:0,scale:1}),i.reDraw()}),document.getElementById("undo").addEventListener("click",()=>{i.undo()});const l=document.getElementById("download");l.addEventListener("click",()=>{l.setAttribute("download","image.png"),l.setAttribute("href",i.canvas.toDataURL("image/png"))}),N.addEventListener("click",e=>{let t=e.target;t.tagName!=="BUTTON"&&(t=_(t,"BUTTON"));const o=t.dataset.type;o!==void 0&&(s.currentDrawable=o)}),window.addEventListener("load",()=>{te(),ee()})},a=class extends G{constructor(){super();h(this,"isDrawing");h(this,"isDragging");h(this,"timer",0);h(this,"currentDraw",null);a.canvas=document.getElementById("canvas"),a.ctx=a.canvas.getContext("2d"),a.canvas.width=document.body.clientWidth,a.canvas.height=document.body.clientHeight,this.isDrawing=!1,this.isDragging=!1,this.createDrawable(),a.clearCanvas()}initializeEvents(){this.onResizeEvent(this.onResize.bind(this)),this.onMouseDownEvent(this.onMouseDown.bind(this)),this.onMouseMoveEvent(this.onMouseMove.bind(this)),this.onMouseUpEvent(this.onMouseUp.bind(this)),this.onMouseLeaveEvent(this.onMouseUp.bind(this)),this.onContextMenuEvent(this.onContextMenu.bind(this)),this.onWheelEvent(this.onMouseWheel.bind(this)),this.onTouchStartEvent(this.onTouchStart.bind(this)),this.onTouchMoveEvent(this.onTouchMove.bind(this)),this.onTouchEndEvent(this.onTouchEnd.bind(this)),this.onKeydownEvent(this.onKeyDown.bind(this)),ne()}onContextMenu(t){t.preventDefault()}onResize(){a.canvas.width=document.body.clientWidth,a.canvas.height=document.body.clientHeight,a.clearCanvas(),a.reDraw()}static reDraw(){a.history.length!=0&&(a.clearCanvas(),a.history.forEach(t=>{a.ctx.strokeStyle=t.properties.strokeColor,a.ctx.fillStyle=t.properties.fillColor,a.ctx.lineWidth=t.properties.lineWidth*s.scale,a.ctx.moveTo(t.properties.initialX,t.properties.initialY),a.ctx.beginPath(),a.ctx.lineCap="round",t.reDraw(),a.ctx.closePath()}),a.ctx.strokeStyle=s.strokeColor,a.ctx.lineWidth=s.lineWidth*s.scale)}startDraw(t){var o;this.isDrawing&&(a.ctx.strokeStyle=s.strokeColor,a.ctx.fillStyle=s.fillColor,a.ctx.lineWidth=s.lineWidth*s.scale,this.createDrawable(),(o=this.currentDraw)==null||o.startDraw(t))}draw(t){var o;this.isDrawing&&(clearTimeout(this.timer),a.isPerfectShape||(this.timer=setTimeout(()=>{var r;a.isPerfectShape=!0,(r=this.currentDraw)==null||r.draw(t)},600)),(o=this.currentDraw)==null||o.draw(t))}endDraw(t){var o,r;this.isDrawing&&((o=this.currentDraw)==null||o.endDraw(t),(r=this.currentDraw)!=null&&r.isEmpty()||(a.history.push(this.currentDraw),y())),this.isDrawing=!1,this.isDragging=!1,a.isPerfectShape=!1,clearTimeout(this.timer)}onMouseDown(t){t.preventDefault(),this.isDrawing=t.button==0,this.isDragging=t.button==1,n.cursorX=t.pageX,n.cursorY=t.pageY,n.prevCursorX=t.pageX,n.prevCursorY=t.pageY,this.startDraw(t)}onMouseMove(t){n.cursorX=t.pageX,n.cursorY=t.pageY,this.draw(t),this.isDragging&&(s.offsetX+=(n.cursorX-n.prevCursorX)/s.scale,s.offsetY+=(n.cursorY-n.prevCursorY)/s.scale,a.reDraw()),n.prevCursorX=n.cursorX,n.prevCursorY=n.cursorY}onMouseUp(t){this.endDraw(t)}onMouseWheel(t){var v;if(this.isDrawing){(v=this.currentDraw)==null||v.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}const r=-t.deltaY/500,c=s.scale*(1+r);if(c<.1||c>10)return;s.scale=c;var u=t.pageX/a.canvas.clientWidth,d=t.pageY/a.canvas.clientHeight;const p=n.getWidth()*r,w=n.getHeight()*r,g=p*u,Y=w*d;s.offsetX-=g,s.offsetY-=Y,a.reDraw()}onTouchStart(t){this.isDrawing=t.touches.length==1,this.isDragging=t.touches.length>=2,n.prevTouches[0]=t.touches[0],n.prevTouches[1]=t.touches[1],this.startDraw(t)}onTouchMove(t){var g,Y,v;if(n.prevTouches[0]===null||n.prevTouches[1]===null)return;const o=t.touches[0].pageX,r=t.touches[0].pageY,c=n.prevTouches[0].pageX,u=n.prevTouches[0].pageY;if(this.draw(t),this.isDragging){if(this.isDrawing){(g=this.currentDraw)==null||g.cancelDraw(),this.createDrawable(),this.isDrawing=!1,this.isDragging=!1;return}t.preventDefault();const m=t.touches[1].pageX,E=t.touches[1].pageY,x=(Y=n.prevTouches[1])==null?void 0:Y.pageX,C=(v=n.prevTouches[1])==null?void 0:v.pageY,b=(o+m)/2,S=(r+E)/2,O=(c+x)/2,B=(u+C)/2,z=Math.sqrt(Math.pow(o-m,2)+Math.pow(r-E,2)),A=Math.sqrt(Math.pow(c-x,2)+Math.pow(u-C,2));var d=z/A;const X=s.scale*d;if(X<.1||X>10)return;s.scale=X;const M=1-d,U=b-O,K=S-B;s.offsetX+=U/s.scale,s.offsetY+=K/s.scale;var p=b/a.canvas.clientWidth,w=S/a.canvas.clientHeight;const $=n.getWidth()*M,q=n.getHeight()*M,J=$*p,j=q*w;s.offsetX+=J,s.offsetY+=j,a.reDraw()}n.prevTouches[0]=t.touches[0],n.prevTouches[1]=t.touches[1]}onTouchEnd(t){this.endDraw(t),n.prevTouches[0]=null,n.prevTouches[1]=null}onKeyDown(t){t.ctrlKey&&(t.key===""||t.key==="z")&&a.undo()}static undo(){a.history.length!==0&&(a.clearCanvas(),a.history.pop(),y(),a.reDraw())}static clearBoard(){a.clearCanvas(),a.history=[],y()}createDrawable(){this.currentDraw=T.create(s.currentDrawable,{strokeColor:s.strokeColor,lineWidth:s.lineWidth,fillColor:s.fillColor})}static clearCanvas(t=null){a.ctx.fillStyle=s.canvasColor,t===null?a.ctx.fillRect(0,0,document.body.clientWidth,document.body.clientHeight):a.ctx.fillRect(t.prevX,t.prevY,t.x,t.y),a.ctx.fillStyle=s.fillColor}};let i=a;h(i,"canvas"),h(i,"ctx"),h(i,"isPerfectShape",!1),h(i,"history",[]);const re=new i;re.initializeEvents();
